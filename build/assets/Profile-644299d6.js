import{a3 as F,b as p,r as B,j as l,c as a,T as d,e as u,B as h,d as s,L as D}from"./index-4b98aa60.js";import{L as v}from"./LoadingButton-b7be2e76.js";import{C as H}from"./Container-1dab81eb.js";import{C as x}from"./Card-e745718f.js";const z=()=>{const f=F(),m=p(e=>e.authSlice.loading),w=p(e=>e.authSlice.sidebarFull),N=p(e=>e.authSlice.sidebarVisible),c=p(e=>e.authSlice.user),[t,b]=B.useState({currentPass:"",newPass:"",repeatNewPass:"",changePassMode:!1,changePassLabel:"Change Password",verificationCode:"",verificationMode:c.emailConfirmationStatus==="Pending",verificationLabel:`Verification code was sent to ${c.email}.`,email:"",resendLetterMode:!1,resendLetterLabel:"Resend Verification Code",deleteAccountMode:!1,deleteAccountLabel:"Delete Account"}),i=(e,n)=>{b(r=>({...r,[n]:e}))},o=(e,n)=>{b(r=>({...r,[e]:n}))},g=async e=>{e.preventDefault();const[n,r,k]=[t.currentPass,t.newPass,t.repeatNewPass];if(r.length<6)return i("New password is too short","changePassLabel");if(r.toLowerCase()!==k.toLowerCase())return i("New passwords don't match","changePassLabel");if(r.toLowerCase()===n.toLowerCase())return i("Old and new passwords are the same","changePassLabel");const V=await f.changePassword(n,r);i(V,"changePassLabel"),i("","currentPass"),i("","newPass"),i("","repeatNewPass")};let P=t.changePassMode?l("form",{className:"password-change-form profile-card scale-in",onSubmit:g,children:[a(d,{className:"profile-card-item",component:"h6",variant:"h6",children:t.changePassLabel}),a(u,{className:"scale-in profile-card-item",size:"medium",value:t.currentPass,onChange:e=>{i(e.target.value,"currentPass")},required:!0,fullWidth:!0,label:"Old Password",type:"password",autoComplete:"new-password"}),a(u,{className:"scale-in profile-card-item",size:"medium",value:t.newPass,onChange:e=>{i(e.target.value,"newPass")},required:!0,fullWidth:!0,label:"New Password",type:"password",autoComplete:"new-password"}),a(u,{className:"scale-in profile-card-item",size:"medium",value:t.repeatNewPass,onChange:e=>{i(e.target.value,"repeatNewPass")},required:!0,fullWidth:!0,label:"Repeat New Password",type:"password",autoComplete:"new-password"}),l(h,{className:"profile-buttons profile-card-item",children:[a(s,{type:"submit",variant:"outlined",onClick:()=>{o("changePassMode",!1)},className:"button",children:"Back"}),m?a(v,{className:"button",loading:!0,variant:"contained"}):a(s,{type:"submit",variant:"contained",className:"button",children:"Submit"})]})]}):null;const C=async e=>{e.preventDefault();const n=t.verificationCode,r=await f.verifyAccount(n);o(r)};let L=t.verificationMode?l("form",{className:"verification-form profile-card scale-in",onSubmit:C,children:[a(d,{className:"verification-label profile-card-item",component:"h6",variant:"h6",children:t.verificationLabel}),a(u,{className:"verification-input scale-in profile-card-item",value:t.verificationCode,onChange:e=>{i(e.target.value,"verificationCode")},required:!0,fullWidth:!0,label:"Verification Code",type:"text"}),l(h,{className:"profile-buttons profile-card-item",children:[a(s,{type:"submit",variant:"outlined",onClick:()=>{o("verificationMode",!1)},className:"button",children:"Back"}),m?a(v,{className:"button",loading:!0,variant:"contained"}):a(s,{type:"submit",variant:"contained",className:"button",children:"Verify"})]})]}):null;const y=async e=>{e.preventDefault();const n=t.email,r=await f.sendVerificationLetter(n);i(r,"verificationLabel")};let A=t.resendLetterMode?l("form",{className:"send-verification-letter-form profile-card scale-in",onSubmit:y,children:[a(d,{className:"profile-card-item",component:"h6",variant:"h6",children:t.resendLetterLabel}),a(u,{className:"scale-in profile-card-item",size:"medium",defaultValue:c.email,value:t.email,onChange:e=>{i(e.target.value,"email")},required:!0,fullWidth:!0,label:"Email",type:"email",autoComplete:"email"}),l(h,{className:"profile-buttons profile-card-item",children:[a(s,{type:"submit",variant:"outlined",onClick:()=>{o("resendLetterMode",!1)},className:"button",children:"Back"}),m?a(v,{className:"button",loading:!0,variant:"contained"}):a(s,{type:"submit",variant:"contained",className:"button",children:"Submit"})]})]}):null;const M=async e=>{e.preventDefault();const n=await f.deleteAccount(t.currentPass);i(n,"deleteAccountLabel")};let S=t.deleteAccountMode?l("form",{className:"delete-account-form profile-card scale-in",onSubmit:M,children:[a(d,{className:"profile-card-item",component:"h6",variant:"h6",children:t.deleteAccountLabel}),a(u,{className:"scale-in profile-card-item",size:"medium",value:t.currentPass,onChange:e=>{i(e.target.value,"currentPass")},required:!0,fullWidth:!0,label:"Enter your password",type:"password",autoComplete:"new-password"}),l(h,{className:"profile-buttons profile-card-item",children:[a(s,{type:"submit",variant:"outlined",onClick:()=>{o("deleteAccountMode",!1),i("","currentPass")},className:"button",children:"Back"}),m?a(v,{className:"button",loading:!0,variant:"contained"}):a(s,{type:"submit",variant:"contained",color:"error",className:"button",children:"Delete"})]})]}):null;return a(H,{component:"main",className:`profile ${N?`page-${w?"compact":"full"}`:"page"}`,children:m?a(D,{height:"100%"}):P||L||A||S||l(x,{className:"profile-card scale-in",children:[a(d,{className:"username profile-card-item",component:"h5",variant:"h5",children:`${c.name}`}),a(d,{className:"profile-card-item",component:"h6",variant:"h6",children:`Email : ${c.email}`}),a(s,{variant:"outlined",onClick:()=>{o("changePassMode",!0)},className:"change-password profile-card-item",children:"Change Password"}),c.emailConfirmationStatus==="Pending"&&a(s,{variant:"outlined",onClick:()=>{o("verificationMode",!0)},className:"verify-account profile-card-item",children:"Verify Account"}),c.emailConfirmationStatus==="Pending"&&a(s,{variant:"outlined",onClick:()=>{o("resendLetterMode",!0)},className:"send-verification-letter profile-card-item",children:"Resend Verification Letter"}),a(s,{variant:"outlined",color:"error",onClick:()=>{o("deleteAccountMode",!0)},className:"delete-account profile-card-item",children:"Delete Account"})]})})};export{z as default};
