import{ao as Q,b as r,a as j,a7 as O,a8 as R,r as w,j as c,c as t,B as o,d as D,C as q,T as h,e as y,f as z,L as A}from"./index-4b98aa60.js";import{c as G,d as V}from"./index.esm-4f3fb3f8.js";import{T as _}from"./Toolbar-b8b39b15.js";import{C as U}from"./Container-1dab81eb.js";import{C as I}from"./Card-e745718f.js";import{D as S}from"./DatePicker-94f39176.js";import"./InputAdornment-39d9477e.js";const ae=()=>{const l=Q(),N=r(e=>e.habitsSlice.habitLoading),W=r(e=>e.authSlice.darkMode),f=r(e=>e.authSlice.sidebarFull),C=r(e=>e.authSlice.sidebarVisible),m=new Date(r(e=>e.habitsSlice.datepickerDate)),v=r(e=>e.habitsSlice.habitList),x=r(e=>e.habitsSlice.habitListLoaded),[p,b]=[j(),O()],g=new URLSearchParams(b.search),[H,T]=[g.get("sort"),g.get("search")],L=R([...v],"habit",H,T),k=new Date().setHours(0,0,0,0)+864e5*(new Date().getDay()?1-new Date().getDay():-6),M=k+864e5*7-1,d=new Date(m.setHours(0,0,0,0)+864e5*(m.getDay()?1-m.getDay():-6)),$=new Date(new Date(d).setHours(23,59,59,999)+864e5*6),E=d.getTime()===k,[i,B]=w.useReducer((e,a)=>({...e,...a}),{selectedDateWeekStart:d,selectedDateWeekEnd:$,isCurrentWeek:E}),F=[1,2,3,4,5,6,0],P={0:"Sun",1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri",6:"Sat"},u=async e=>{e=e||new Date;const a=i.selectedDateWeekStart.getTime(),s=i.selectedDateWeekEnd.getTime(),n=new Date(e).setHours(0,0,0,0)+864e5*(e.getDay()?1-e.getDay():-6);(e.getTime()<a||n>s)&&l.loadHabitsData(new Date(n)),B({selectedDateWeekStart:new Date(n),selectedDateWeekEnd:new Date(new Date(n).setHours(23,59,59,999)),isCurrentWeek:n===k})};return w.useEffect(()=>{const e=new Date(new Date().setHours(0,0,0,0)+864e5*(new Date().getDay()?1-new Date().getDay():-6));x||l.loadHabitsData(e)},[]),c(U,{component:"main",className:`habits ${C?`page-${f?"compact":"full"}`:"page"}`,children:[t(_,{mode:"habit",addNewItem:()=>p(`${b.pathname}/new-habit`)}),c(o,{className:`habit-week-range${W?"-dark":""} scale-in`,children:[c(D,{variant:"outlined",className:"button habit-date-button",onClick:()=>{u(new Date(i.selectedDateWeekStart.getTime()-864e5*7))},children:[t(q,{className:"habit-date-button-icon icon-interactive nav-icon"}),t(h,{className:"habit-date-button-text",children:"Prev Week"})]}),t(S,{inputFormat:"dd/MM/yyyy",className:"habit-date-picker date-picker",desktopModeMediaQuery:"@media (min-width:769px)",renderInput:e=>t(y,{size:"small",className:"focus date-picker habit-date",...e}),value:i.selectedDateWeekStart,onChange:e=>{u(e)},maxDate:new Date(M)}),t(S,{inputFormat:"dd/MM/yyyy",className:"habit-date-picker date-picker",desktopModeMediaQuery:"@media (min-width:769px)",renderInput:e=>t(y,{size:"small",className:"focus date-picker habit-date",...e}),value:i.selectedDateWeekEnd,onChange:e=>{u(e)},disabled:!0}),c(D,{disabled:!!i.isCurrentWeek,variant:"outlined",className:"button habit-date-button",onClick:()=>{u(new Date(i.selectedDateWeekStart.getTime()+864e5*7))},children:[t(h,{className:"habit-date-button-text",children:"Next Week"}),t(z,{className:"habit-date-button-icon icon-interactive nav-icon"})]})]}),N?t(A,{height:"80vh"}):t(o,{className:"habit-list scale-in",children:L.map(e=>c(I,{variant:"elevation",className:"habit-list-item",children:[t(o,{className:"habit-list-item-title",onClick:()=>{p(`${b.pathname}/${e._id}`)},children:t(h,{className:"habit-list-item-title-text",children:e.title})}),Object.values(e.entries).every(a=>a===null)?t(D,{onClick:()=>{l.populateHabit(new Date(d),e)},className:"populate-week",children:"Poplulate with Entries"}):t(o,{className:"habit-weekdays",children:F.map(a=>{const s=e.entries[a];if(s){const n=new Date(s.date).toLocaleDateString("en-GB")===new Date().toLocaleDateString("en-GB");return c(o,{className:"habit-weekday",onClick:()=>{l.changeHabitStatus(s,a)},children:[t(h,{className:`habit-weekday-label ${n&&"current-day"}`,children:P[a]}),s.status==="Complete"?t(G,{className:`icon-interactive habit-weekday-icon ${s.status}`}):t(V,{className:`icon-interactive habit-weekday-icon ${s.status}`})]},a)}else return null})})]},e._id))})]})};export{ae as default};
