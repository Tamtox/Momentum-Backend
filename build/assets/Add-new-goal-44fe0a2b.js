import{a7 as y,a as x,as as H,r as m,b as p,c as t,B as o,L,j as n,d,ai as B,T as f,aj as I,e as w}from"./index-4b98aa60.js";import{C as F}from"./Card-e745718f.js";import{F as j,a as z,S as M}from"./Switch-0b4bb37c.js";import{D as P}from"./DatePicker-94f39176.js";import"./InputAdornment-39d9477e.js";const $=()=>{const D=y(),c=x(),r=H(),u=m.useRef(null),v=a=>{a.target===u.current&&c("/goals")},N=p(a=>a.goalSlice.goalLoading),C=p(a=>a.goalSlice.goalList),T=D.pathname.split("/")[2],e=C.find(a=>a._id===T),[s,i]=m.useState({addNewGoalHeader:"",goalTitle:(e==null?void 0:e.title)||"",selectedDate:e!=null&&e.targetDate?new Date(e.targetDate):null,goalCreationUTCOffset:(e==null?void 0:e.creationUTCOffset)||new Date().getTimezoneOffset(),goalAlarmUsed:(e==null?void 0:e.alarmUsed)||!1}),k=(a,l)=>{i(g=>({...g,[l]:a}))},b=()=>{i(a=>({...a,goalAlarmUsed:!a.goalAlarmUsed}))},U=a=>{i(l=>({...l,selectedDate:a}))},h=(a,l)=>{l==="archive"?r.toggleGoalArchiveStatus(a):r.deleteGoal(a),c("/goals")},A=async a=>{a.preventDefault();const l={title:s.goalTitle,creationDate:(e==null?void 0:e.creationDate)||new Date().toISOString(),targetDate:s.selectedDate?new Date(s.selectedDate.setHours(12+new Date().getTimezoneOffset()/-60,0,0,0)).toISOString():null,status:(e==null?void 0:e.status)||"Pending",dateCompleted:(e==null?void 0:e.dateCompleted)||"",isArchived:(e==null?void 0:e.isArchived)||!1,creationUTCOffset:s.goalCreationUTCOffset,alarmUsed:s.goalAlarmUsed,_id:(e==null?void 0:e._id)||""};e?r.updateGoal(l,e):r.addGoal(l),c("/goals")};return m.useEffect(()=>{if(e){const{title:a,targetDate:l,creationUTCOffset:g,alarmUsed:S}=e;i(O=>({...O,goalTitle:a||"",selectedDate:l?new Date(l):null,goalCreationUTCOffset:g||new Date().getTimezoneOffset(),goalAlarmUsed:S||!1}))}},[e]),t(o,{className:"add-new-goal-backdrop backdrop opacity-transition",ref:u,onClick:a=>v(a),children:N?t(L,{height:"80vh"}):n(F,{component:"form",className:"add-new-goal-form scale-in",onSubmit:A,children:[n(o,{className:"add-new-goal-controls",children:[e?t(o,{className:"archive-goal-wrapper",children:n(d,{className:"archive-goal-button",variant:"outlined",onClick:()=>{h(e,"archive")},children:[t(B,{className:"icon-interactive archive-goal-icon"}),t(f,{className:"archive-goal-text",children:"Archive"})]})}):null,e?t(o,{className:"delete-goal-wrapper",children:n(d,{className:"delete-goal-button",variant:"outlined",onClick:()=>{h(e,"delete")},children:[t(I,{className:"icon-interactive delete-goal-icon"}),t(f,{className:"delete-goal-text",children:"Delete"})]})}):null]}),t(o,{className:"add-new-goal-dates",children:t(o,{className:"add-new-goal-datepicker-wrapper",children:t(P,{className:"focus add-new-goal-datepicker",inputFormat:"dd/MM/yyyy",label:"Goal Target Date",desktopModeMediaQuery:"@media (min-width:769px)",renderInput:a=>t(w,{size:"small",...a}),value:s.selectedDate,onChange:a=>{U(a)},closeOnSelect:!0,componentsProps:{actionBar:{actions:["today","clear"]}}})})}),s.selectedDate?t(o,{className:"add-new-goal-alarm-switches",children:t(j,{children:t(z,{control:t(M,{checked:s.goalAlarmUsed,onChange:b}),label:"Goal alarm"})})}):null,t(w,{value:s.goalTitle,onChange:a=>{k(a.target.value,"goalTitle")},className:"add-new-goal-title focus input",label:"Goal Title",multiline:!0,required:!0}),n(o,{className:"add-new-goal-buttons",children:[t(d,{variant:"outlined",className:"button",onClick:()=>{c(-1)},children:"Back"}),t(d,{variant:"outlined",type:"submit",className:"button",children:e?"Update":"Submit"})]})]})})};export{$ as default};
